package castboard.view;

import castboard.domain.CatalogsHandler;

import javax.swing.JOptionPane;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.JTextField;
import javax.swing.JPasswordField;
import java.awt.BorderLayout;

public class LoginPopUp extends PetitionPopUp
{
	private JTextField txtAgent;
	private JPasswordField txtPass;
	
	public LoginPopUp(JFrame frmParent)
	{
		super(frmParent, null);
		
		createPnlForm();
	}
	
	public void display ()
	{
			String title = "Inicio de sesión - CastBoard";
			ImageIcon icon = new ImageIcon("castboard/res/icons/" + 
														"ico_64_cb.png");
														
			int option = JOptionPane.showConfirmDialog
							 (
								 frmParent,
								 pnlForm,
								 title,
								 JOptionPane.OK_CANCEL_OPTION,
								 JOptionPane.PLAIN_MESSAGE,
								 icon
							 );
							 
		if (option == JOptionPane.OK_OPTION)
		{
			String user = txtAgent.getText();
			String pass = new String(txtPass.getPassword());
			
			if (CatalogsHandler.connect(user, pass))
				((MasterFrame) frmParent).login();
		}
	}
	
	private void createPnlForm ()
	{
		JLabel lblAgent = new JLabel("Agente");
		JLabel lblPass = new JLabel("Contraseña");
		
		txtAgent = new JTextField(16);
		txtPass = new JPasswordField(16);
		
		JPanel pnlAgent = new JPanel();
		JPanel pnlPass = new JPanel();
		
		pnlForm = new JPanel();
		pnlForm.setLayout(new BorderLayout());
		
		pnlAgent.add(lblAgent);
		pnlAgent.add(txtAgent);
		pnlPass.add(lblPass);
		pnlPass.add(txtPass);
		
		pnlForm.add(pnlAgent, BorderLayout.NORTH);
		pnlForm.add(pnlPass, BorderLayout.SOUTH);
	}
}